<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è½¬ç›˜æŠ½å¥–</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: #121212;
            font-family: 'Microsoft YaHei', sans-serif;
            overflow: hidden;
        }
        
        .wheel-container {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 0 auto;
        }
        
        canvas {
            display: block;
            margin: 0 auto;
            border-radius: 50%;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.8);
            background: #000;
            width: 100%;
            height: 100%;
        }
        
        .pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-top: 50px solid #FF0000;
            z-index: 10;
            filter: drop-shadow(0 5px 10px rgba(255, 0, 0, 0.5));
        }
        
        .pointer::after {
            content: '';
            position: absolute;
            top: -15px;
            left: -15px;
            width: 30px;
            height: 30px;
            background: #FF0000;
            border-radius: 50%;
        }
        
        .spin-btn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(45deg, #FF6B6B, #FF8E53);
            border: none;
            color: white;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            z-index: 5;
            box-shadow: 0 0 30px rgba(255, 107, 107, 0.8);
            transition: all 0.3s;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }
        
        .spin-btn:hover:not(:disabled) {
            transform: translate(-50%, -50%) scale(1.1);
            box-shadow: 0 0 40px rgba(255, 107, 107, 1);
        }
        
        .spin-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        #result {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 500px;
            padding: 25px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            font-size: 28px;
            font-weight: bold;
            color: white;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 100;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            opacity: 0;
            transition: opacity 0.5s, transform 0.5s;
            transform: translateX(-50%) translateY(50px);
        }
        
        #result.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        
        .control-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            color: white;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }
        
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        @media (max-width: 500px) {
            .wheel-container {
                width: 300px;
                height: 300px;
            }
            
            #result {
                font-size: 22px;
                padding: 20px;
            }
            
            .spin-btn {
                width: 80px;
                height: 80px;
                font-size: 18px;
            }
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        .sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 10px white;
            animation: sparkle 2s infinite;
        }
    </style>
</head>
<body>
    <div class="wheel-container">
        <canvas id="wheelCanvas" width="400" height="400"></canvas>
        <div class="pointer"></div>
        <button class="spin-btn" id="spinBtn">GO</button>
    </div>
    
    <div id="result"></div>
    
    <div class="controls">
        <button class="control-btn" id="stopBtn" disabled>â¹ï¸</button>
        <button class="control-btn" id="resetBtn">ğŸ”„</button>
    </div>

    <script>
        class SimpleLotteryWheel {
            constructor() {
                this.canvas = document.getElementById('wheelCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.spinBtn = document.getElementById('spinBtn');
                this.stopBtn = document.getElementById('stopBtn');
                this.resetBtn = document.getElementById('resetBtn');
                this.resultEl = document.getElementById('result');
                
                // è½¬ç›˜é…ç½®
                this.centerX = this.canvas.width / 2;
                this.centerY = this.canvas.height / 2;
                this.radius = Math.min(this.centerX, this.centerY) - 20;
                
                // å®šä¹‰ä¸ƒä¸ªå¥–é¡¹ - è°ƒæ•´é¡ºåºï¼Œè®©"å†æ¥ä¸€æ¬¡"åœ¨ç´¢å¼•0ï¼Œ"ç¥ç§˜ç¤¼åŒ…"åœ¨ç´¢å¼•1
                this.prizes = [
                    { name: 'ç¥ç§˜ç¤¼åŒ…', color: '#FF9800', weight: 0 }, // ç´¢å¼•0
                    { name: 'å†æ¥ä¸€æ¬¡', color: '#FF5252', weight: 100 }, // ç´¢å¼•1
                    { name: 'è°¢è°¢å‚ä¸', color: '#FFEB3B', weight: 0 },
                    { name: 'å¥¶èŒ¶ä¸€æ¯', color: '#4CAF50', weight: 0 },
                    { name: 'è€ƒè¯•å¿…è¿‡', color: '#2196F3', weight: 0 },
                    { name: 'å¹¸è¿+999', color: '#9C27B0', weight: 0 },
                    { name: 'çˆ±å¿ƒå¥¶èŒ¶', color: '#E91E63', weight: 0 }
                ];
                
                // åŠ¨ç”»ç›¸å…³
                this.prizeCount = this.prizes.length;
                this.angleStep = (2 * Math.PI) / this.prizeCount; // æ¯ä¸ªæ‰‡å½¢çš„å¼§åº¦
                
                // è®¡ç®—èµ·å§‹è§’åº¦ï¼šè®©"å†æ¥ä¸€æ¬¡"ï¼ˆç´¢å¼•0ï¼‰çš„ä¸­å¿ƒç‚¹å¯¹å‡†æŒ‡é’ˆ
                // ç”±äºCanvasçš„0å¼§åº¦åœ¨3ç‚¹é’Ÿæ–¹å‘ï¼Œè€ŒæŒ‡é’ˆåœ¨12ç‚¹é’Ÿæ–¹å‘ï¼Œéœ€è¦å‡å»Ï€/2è¿›è¡Œæ ¡æ­£
                const startPrizeIndex = 0;
                this.startAngle = (startPrizeIndex * this.angleStep + this.angleStep / 2) - Math.PI / 2;
                
                // è®¡ç®—ç›®æ ‡è§’åº¦ï¼šè®©"ç¥ç§˜ç¤¼åŒ…"ï¼ˆç´¢å¼•1ï¼‰çš„ä¸­å¿ƒç‚¹å¯¹å‡†æŒ‡é’ˆ
                const targetPrizeIndex = 1;
                this.targetAngle = (targetPrizeIndex * this.angleStep + this.angleStep / 2) - Math.PI / 2;
                
                // è®¡ç®—ä»èµ·å§‹ä½ç½®åˆ°ç›®æ ‡ä½ç½®éœ€è¦æ—‹è½¬çš„è§’åº¦
                // ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯é€†æ—¶é’ˆæ—‹è½¬ï¼ˆå› ä¸ºCanvasåæ ‡ç³»ä¸­æ­£è§’åº¦æ˜¯é€†æ—¶é’ˆï¼‰
                // æ‰€ä»¥ä»"å†æ¥ä¸€æ¬¡"ï¼ˆç´¢å¼•0ï¼‰åˆ°"ç¥ç§˜ç¤¼åŒ…"ï¼ˆç´¢å¼•1ï¼‰æ˜¯é¡ºæ—¶é’ˆæ—‹è½¬ä¸€ä¸ªæ‰‡åŒº
                // å¯¹äºé€†æ—¶é’ˆæ—‹è½¬ç³»ç»Ÿï¼Œè¿™ç›¸å½“äºé€†æ—¶é’ˆæ—‹è½¬(æ€»æ‰‡å½¢æ•°-1)ä¸ªæ‰‡åŒº
                const clockwiseDistance = (targetPrizeIndex - startPrizeIndex + this.prizeCount) % this.prizeCount;
                this.sectorDistance = clockwiseDistance; // é¡ºæ—¶é’ˆæ–¹å‘çš„æ‰‡åŒºæ•°
                
                this.rotation = this.startAngle;
                this.spinSpeed = 0;
                this.isSpinning = false;
                this.targetPrizeIndex = 1; // æ°¸è¿œåœåœ¨ç¥ç§˜ç¤¼åŒ…ï¼ˆç´¢å¼•1ï¼‰
                this.animationId = null;
                this.spinStartTime = 0;
                this.spinDuration = 4000;
                
                this.init();
                this.drawWheel();
                this.createSparkles();
            }
            
            init() {
                this.spinBtn.addEventListener('click', () => this.startSpin());
                this.stopBtn.addEventListener('click', () => this.stopSpin());
                this.resetBtn.addEventListener('click', () => this.reset());
                
                // é”®ç›˜å¿«æ·é”®
                document.addEventListener('keydown', (e) => {
                    if (e.key === ' ' || e.key === 'Enter') {
                        if (!this.isSpinning) this.startSpin();
                        e.preventDefault();
                    }
                    if (e.key === 's' || e.key === 'S') {
                        if (this.isSpinning) this.stopSpin();
                    }
                    if (e.key === 'r' || e.key === 'R') {
                        this.reset();
                    }
                });
            }
            
            drawWheel() {
                const ctx = this.ctx;
                const centerX = this.centerX;
                const centerY = this.centerY;
                const radius = this.radius;
                const prizeCount = this.prizeCount;
                const angleStep = this.angleStep;
                
                // æ¸…ç©ºç”»å¸ƒ
                ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                // ç»˜åˆ¶è½¬ç›˜èƒŒæ™¯
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius + 5, 0, 2 * Math.PI);
                ctx.fillStyle = '#000';
                ctx.fill();
                
                // ä¿å­˜çŠ¶æ€å¹¶æ—‹è½¬ç”»å¸ƒ
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(this.rotation);
                
                // ç»˜åˆ¶æ‰‡å½¢
                for (let i = 0; i < prizeCount; i++) {
                    const startAngle = i * angleStep;
                    const endAngle = (i + 1) * angleStep;
                    
                    // ç»˜åˆ¶æ‰‡å½¢
                    ctx.beginPath();
                    ctx.moveTo(0, 0);
                    ctx.arc(0, 0, radius, startAngle, endAngle);
                    ctx.closePath();
                    ctx.fillStyle = this.prizes[i].color;
                    ctx.fill();
                    
                    // ç»˜åˆ¶æ‰‡å½¢è¾¹æ¡†
                    ctx.strokeStyle = 'white';
                    ctx.lineWidth = 2;
                    ctx.stroke();
                    
                    // ä¿å­˜çŠ¶æ€ä»¥ç»˜åˆ¶æ–‡å­—
                    ctx.save();
                    
                    // è®¡ç®—æ‰‡å½¢çš„ä¸­å¿ƒè§’åº¦
                    const midAngle = startAngle + angleStep / 2;
                    
                    // æ—‹è½¬åˆ°æ‰‡å½¢çš„ä¸­å¿ƒè§’åº¦
                    ctx.rotate(midAngle);
                    
                    // ç§»åŠ¨åˆ°æ‰‡å½¢ä¸­çš„ä½ç½®ï¼ˆä»åœ†å¿ƒå‘å¤–ç§»åŠ¨ï¼‰
                    const textRadius = radius * 0.6; // æ–‡å­—ä½ç½®ï¼ˆåŠå¾„çš„60%å¤„ï¼‰
                    
                    // ç»˜åˆ¶æ–‡å­— - ç¡®ä¿æ–‡å­—åœ¨æ‰‡å½¢ä¸­å±…ä¸­
                    const prizeName = this.prizes[i].name;
                    
                    // æ ¹æ®æ–‡å­—é•¿åº¦è°ƒæ•´å­—ä½“å¤§å°
                    let fontSize = 18;
                    if (prizeName.length >= 4) fontSize = 16;
                    if (prizeName.length >= 5) fontSize = 14;
                    
                    ctx.font = `bold ${fontSize}px Microsoft YaHei`;
                    ctx.fillStyle = this.getContrastColor(this.prizes[i].color);
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    
                    // ç»˜åˆ¶æ–‡å­— - æ³¨æ„ï¼šè¿™é‡Œæ–‡å­—æ–¹å‘æ˜¯æ²¿ç€åŠå¾„æ–¹å‘
                    ctx.fillText(prizeName, textRadius, 0);
                    
                    // æ¢å¤çŠ¶æ€
                    ctx.restore();
                }
                
                // ç»˜åˆ¶ä¸­å¿ƒåœ†
                ctx.beginPath();
                ctx.arc(0, 0, 30, 0, 2 * Math.PI);
                ctx.fillStyle = 'white';
                ctx.fill();
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 5;
                ctx.stroke();
                
                // ç»˜åˆ¶ä¸­å¿ƒæ–‡å­—
                ctx.fillStyle = '#333';
                ctx.font = 'bold 20px Microsoft YaHei';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('GO', 0, 0);
                
                ctx.restore();
            }
            
            getContrastColor(hexColor) {
                if (!hexColor || hexColor.length < 7) return '#000';
                
                const r = parseInt(hexColor.substr(1, 2), 16);
                const g = parseInt(hexColor.substr(3, 2), 16);
                const b = parseInt(hexColor.substr(5, 2), 16);
                const brightness = (r * 299 + g * 587 + b * 114) / 1000;
                return brightness > 128 ? '#000' : '#FFF';
            }
            
            selectPrizeByWeight() {
                // æ°¸è¿œè¿”å›ç¥ç§˜ç¤¼åŒ…ï¼ˆç´¢å¼•1ï¼‰
                return 1;
            }
            
            startSpin() {
                if (this.isSpinning) return;
                
                this.isSpinning = true;
                this.spinBtn.disabled = true;
                this.stopBtn.disabled = false;
                
                // éšè—ç»“æœæ¡†
                this.resultEl.classList.remove('show');
                
                // å›ºå®šé€‰æ‹©ç¥ç§˜ç¤¼åŒ…ï¼ˆç´¢å¼•1ï¼‰
                this.targetPrizeIndex = this.selectPrizeByWeight();
                
                // é‡ç½®åˆ°èµ·å§‹ä½ç½®
                this.rotation = this.startAngle;
                
                // è®¾ç½®åˆå§‹é€Ÿåº¦
                const baseSpeed = 8 + Math.random() * 4;
                this.spinSpeed = baseSpeed;
                
                this.spinStartTime = Date.now();
                this.animate();
            }
            
            animate() {
                const currentTime = Date.now();
                const elapsed = currentTime - this.spinStartTime;
                const progress = Math.min(elapsed / this.spinDuration, 1);
                
                // ä½¿ç”¨ç¼“åŠ¨å‡½æ•°
                const easeOut = 1 - Math.pow(1 - progress, 3);
                
                // è®¡ç®—ä»èµ·å§‹ä½ç½®åˆ°ç›®æ ‡ä½ç½®éœ€è¦æ—‹è½¬çš„æ€»è§’åº¦
                // æˆ‘ä»¬éœ€è¦é€†æ—¶é’ˆæ—‹è½¬ï¼Œæ‰€ä»¥è§’åº¦ä¸ºè´Ÿæ•°
                // æ€»æ—‹è½¬ = é¢å¤–åœˆæ•°(é€†æ—¶é’ˆ) + ç›®æ ‡è§’åº¦ä¸èµ·å§‹è§’åº¦çš„å·®å€¼
                const extraRotations = 5; // é¢å¤–çš„5åœˆ
                
                // è®¡ç®—é¡ºæ—¶é’ˆæ–¹å‘ä»"å†æ¥ä¸€æ¬¡"åˆ°"ç¥ç§˜ç¤¼åŒ…"çš„è§’åº¦å·®
                const clockwiseAngleDiff = this.sectorDistance * this.angleStep;
                
                // è½¬æ¢ä¸ºé€†æ—¶é’ˆæ—‹è½¬çš„è§’åº¦ï¼ˆCanvasåæ ‡ç³»ï¼‰
                // é€†æ—¶é’ˆæ—‹è½¬è§’åº¦ = 2Ï€ - é¡ºæ—¶é’ˆè§’åº¦
                const counterClockwiseAngleDiff = (2 * Math.PI) - clockwiseAngleDiff;
                
                // æ€»æ—‹è½¬è§’åº¦ = é¢å¤–çš„é€†æ—¶é’ˆåœˆæ•° + é€†æ—¶é’ˆè§’åº¦å·®
                const totalRotation = extraRotations * (2 * Math.PI) + counterClockwiseAngleDiff;
                
                // åº”ç”¨ç¼“åŠ¨å‡½æ•°è®¡ç®—å½“å‰æ—‹è½¬è§’åº¦
                // æ³¨æ„ï¼šè´Ÿå·è¡¨ç¤ºé¡ºæ—¶é’ˆæ—‹è½¬ï¼ˆå®é™…è§†è§‰ä¸Šçš„é¡ºæ—¶é’ˆï¼‰
                this.rotation = this.startAngle + (easeOut * totalRotation);
                
                // é‡æ–°ç»˜åˆ¶
                this.drawWheel();
                
                // æ£€æŸ¥æ˜¯å¦å®Œæˆ
                if (progress < 1) {
                    this.animationId = requestAnimationFrame(() => this.animate());
                } else {
                    this.finishSpin();
                }
            }
            
            finishSpin() {
                this.isSpinning = false;
                this.spinBtn.disabled = false;
                this.stopBtn.disabled = true;
                
                // æ˜¾ç¤ºç»“æœ - å›ºå®šæ˜¾ç¤ºç¥ç§˜ç¤¼åŒ…
                const selectedPrize = this.prizes[1]; // ç›´æ¥ä½¿ç”¨ç´¢å¼•1
                const fullName = 'ç¥ç§˜å¤§ç¤¼åŒ…'; // å›ºå®šæ˜¾ç¤ºå®Œæ•´åç§°
                
                this.resultEl.textContent = `ğŸ‰ ${fullName}`;
                this.resultEl.style.background = selectedPrize.color;
                this.resultEl.classList.add('show');
            }
            
            stopSpin() {
                if (!this.isSpinning) return;
                
                this.isSpinning = false;
                cancelAnimationFrame(this.animationId);
                this.finishSpin();
            }
            
            reset() {
                if (this.isSpinning) {
                    cancelAnimationFrame(this.animationId);
                    this.isSpinning = false;
                }
                
                // é‡ç½®åˆ°èµ·å§‹ä½ç½®ï¼ˆå†æ¥ä¸€æ¬¡ï¼‰
                this.rotation = this.startAngle;
                this.spinSpeed = 0;
                this.targetPrizeIndex = 1;
                this.spinBtn.disabled = false;
                this.stopBtn.disabled = true;
                this.resultEl.classList.remove('show');
                
                this.drawWheel();
            }
            
            createSparkles() {
                // åˆ›å»ºèƒŒæ™¯é—ªçƒæ•ˆæœ
                for (let i = 0; i < 30; i++) {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'sparkle';
                    sparkle.style.left = `${Math.random() * 100}vw`;
                    sparkle.style.top = `${Math.random() * 100}vh`;
                    sparkle.style.animationDelay = `${Math.random() * 2}s`;
                    sparkle.style.opacity = Math.random() * 0.5 + 0.2;
                    document.body.appendChild(sparkle);
                }
            }
        }
        
        // åˆå§‹åŒ–è½¬ç›˜
        const lotteryWheel = new SimpleLotteryWheel();
    </script>
</body>
</html>
